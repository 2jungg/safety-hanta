kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4

# Register NVIDIA runtime for GPU pods
containerdConfigPatches:
- |-
    [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.nvidia]
      runtime_type = "io.containerd.runc.v2"
    [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.nvidia.options]
      BinaryName = "/usr/bin/nvidia-container-runtime"

nodes:
  - role: control-plane

  # Capture workers
  - role: worker
    labels:
      role: capture
    extraMounts:
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/videos
        containerPath: /videos
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/src
        containerPath: /src_host

  # Inference worker (GPU node)
  - role: worker
    labels:
      role: inference
      accelerator: nvidia-gpu
    extraMounts:
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/videos
        containerPath: /videos
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/models
        containerPath: /models
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/src
        containerPath: /src_host

  # Generic worker (can host Redis, RTSPâ€‘sim, etc.)
  - role: worker
    labels:
      role: simulation
    extraMounts:
      - hostPath: C:/Users/HANTA/Documents/safety-hanta/videos
        containerPath: /videos